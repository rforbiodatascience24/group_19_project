---
title: ""
format: revealjs
editor: visual
---

# Final project R for Bio: Group 19 {background-color="brown"}

Ida Sofie Adrian (s243903), Mariam Dalia (s242707), Mathilde Melgaard (s243633), Nina Zomorrodnia (s243923), Victor Hansen (s243634)

## Introduction & Aim {background-color="brown"}

::: columns
::: {.column width="10%" style="font-size: 20px;"}
### Introduction

-   Cervical cancer is a significant cause of mortality in low-income countries.

-   The dataset:

    -   Medical records from 858 female patients.
    -   Random sampling of patients between the years 2012 and 2013.
    -   Gynecology service at Hospital Universitario de Caracas in Caracas, Venezuela.

-   Cervical cancer is a significant cause of mortality in low-income countries.

-   The dataset:

    -   Medical records from 858 female patients
    -   Random sampling of patients between the years 2012 and 2013
    -   Gynecology service at Hospital Universitario de Caracas in Caracas, Venezuela
:::

::: {.column width="10%" style="font-size: 20px;"}
### Aim

-   Find correlation between variables and cancer diagnosis

-   Chi-squared test:

    -   To evaluate whether there is a significant association between two variables.

-   PCA:

    -   To identify patterns and relationships in data.

-   Visualization:

    -   To present the data using various plots.
:::
:::

## Methods: Data cleaning {background-color="brown"}

::: columns
::: {.column width="50%"}
-   Cleaning NAs

-   Change values 1.0 and 0.0 to yes and no

-   Changing columns to numeric

-   Renaming columns for consistency
:::

::: {.column width="50%" style="font-size: 30px;"}

```{r, eval=FALSE, echo=TRUE}
# Changing values 
data_raw <- data_raw |>
  mutate(
    Smokes = case_when(
      Smokes == "0.0" ~ "no",
      Smokes == "1.0" ~ "yes"
    ),
    Hormonal.Contraceptives = case_when(
      Hormonal.Contraceptives == "1.0" ~ "yes",
      Hormonal.Contraceptives == "0.0" ~ "no"
    ),
    IUD = case_when(
      IUD == "0.0" ~ "no",
      IUD == "1.0" ~ "yes"
    ),
    Dx.Cancer = case_when(
      Dx.Cancer == "0" ~ "no",
      Dx.Cancer == "1" ~ "yes"
    )
  )

# 
# Tidying
data_clean <- data_raw |> 
  rename('Smokes.years'= Smokes..years.,
         'Smokes.packs.years' = Smokes..packs.year.) |> 
  rename_with(~ gsub("^STDs\\.\\.", "", .)) |>
  rename_with(~ str_remove(.,"\\.$")) |> #removes the '.' from the last word in columns
  rename_with(~ str_replace_all(., "\\.", "_")) |> 
  rename_with(~ str_replace_all(.x, "__", "_"))
```


:::
:::

## Methods: Data augment {background-color="brown"}

::: columns
::: {.column width="50%"}
-   Creating IDs

-   Pivot_long

-   Tidying names in rows

-   Removing columns

-   Creating new count column for STD

-   Changing the order of columns
:::

::: {.column width="50%" style="font-size: 30px;"}
```{r, eval=FALSE, echo=TRUE}
# Changing data to long
data_long <- data_clean |>
  pivot_longer(cols = starts_with("STDs_"), 
               names_to = "STD_type", 
               values_to = "has_STD") |>
  mutate(
    STD = ifelse(has_STD == 1, STD_type, NA)  # Keep STD name where 1 is present
  ) |>
  group_by(ID) |>
  mutate(
    # Concatenate STD names for each ID, if none, set "No"
    STD = ifelse(all(is.na(STD)), "No", paste(na.omit(STD), collapse = ", "))
  ) |>
  ungroup() |>
  select(-STD_type, -has_STD) |>
  distinct() |> 
  separate_rows(STD, sep = ",")

# Creating new column
data_long <- data_long |> 
  group_by(ID) |> 
  mutate(Number_of_STDs = if_else(all(is.na(STD) | STD == "No"), 0, n_distinct(STD, na.rm = TRUE))) |> 
  ungroup()       
  )
```

:::
:::

## Results: Barplot {background-color="brown"}

::: columns
::: {.column width="50%" style="font-size: 16px;"}


![](../results/images/05_barplot_STD.png){width="100%"}


```{r, eval=FALSE, echo=TRUE}
x <- 1:10
y <- x^2
plot(x, y, main = "A Simple Plot")

sbjdfnlskd

snjdnækds

nsjdnfls
```

:::

::: {.column width="50%" style="font-size: 20px;"}

* Few women have STDs, regardless of cervical cancer diagnosis status


* Among women with cancer, HPV seems to be the only STD that is present.


* Among women without cancer, they have few cases in different types of STDs but no cases with HPV specifically.

:::
:::


## Results: Boxplot {background-color="brown"}
::: columns
::: {.column width="50%" style="font-size: 16px;"}
![](../results/images/05_boxplot_sex_his.png){width="120%"}
```{r, eval=FALSE, echo=TRUE}
x <- 1:10
y <- x^2
plot(x, y, main = "A Simple Plot")

sbjdfnlskd

snjdnækds

nsjdnfls
```

:::

::: {.column width="50%" style="font-size:  16px;"}

* The average number of sexual partners is higher among women with cervical cancer compared the women without. Although looking at the boxplots, it does not seem that the number of sexual partners correlate with whether the women are diagnosed with cervical cancer.

* In contrast, there seem to be a small correlation between the age of first sexual intercourse and cervical cancer diagnosis for the women in the dataset.

* Among the women with diagnosed cervical cancer, the age of first sexual intercourse ranges from around 18-19 excluding a few outlier cases.
Among the women without cervical cancer, the age of first sexual intercourse ranges from 15-18 years, also excluding a outlier cases.

* Our hypothesis would be that women that have their first sexual intercourse at a young age tend to get STDs and later cervical cancer, but this does not seem to be the case.

:::
:::


## Results: Function for Correlation Visualization of Categorical Variables {background-color="brown"}

-   Compare categorical variables such as:

    -   IUD

    -   Hormonal Contraceptives

    -   Smoking

    -   Cancer diagnosis

-   Input: dataset and two variables

-   Returns: stratified bar plot

## Results: Function for contingency table and correlation score {background-color="brown"}

-   Input: dataset and two variables

-   Returns: contingency table and chi-2

## Results: PCA {background-color="brown"}

::: columns
::: {.column width="50%"}
-   Numeric values

-   Scaling data

-   Two distinct clusters

:::

::: {.column width="50%" style="font-size: 25px;"}
```{r, eval=FALSE, echo=TRUE}
cancer_data <- data_aug |> 
  select(-Time_since_first_diagnosis, -Time_since_last_diagnosis, Dx_CIN) |> drop_na() 

pca_fit_cancer <- cancer_data |> 
  select(where(is.numeric)) |>  
  prcomp(scale = TRUE)

scatterplot_pca <- pca_fit_cancer |> 
  augment(cancer_data) |> 
  ggplot(aes(.fittedPC1, .fittedPC2, color = factor(Cancer))) + 
  geom_point(size = 1.5) +
  theme_half_open(12) + background_grid() + scale_color_discrete(labels = c("0" = "Negative", "1" = "Positive")) +
  labs(color = "Cervical Cancer Present") + ggtitle("PCA Plot") + theme(plot.title = element_text(hjust = 0.5))

```

![](../results/images/PC_variance.png){width="100%"}
:::
:::

## Results: PCA {background-color="brown"}

::: columns
::: {.column width="50%" style="font-size: 18px;"}
-   Extract the rotation matrix

-   Arrows in similar directions = positive correlation

-   Arrows in opposite directions = negative correlation

-   Arrows near the origin = minimal contribution to the components

-   The length of an arrow = amount of contribution to the components

![](../results/images/PC_coordinates.png){width="60%"}
:::

::: {.column width="50%" style="font-size: 18px;"}
-   Extract Eigenvalues of the PCA

-   Represents the amount of variance explained by each principal component

-   PC4 and PC5 explains 50-60% of the variance

![](../results/images/PC_variance.png){width="80%"}
:::
:::

## Conclusions {background-color="brown"}

-   No strong correlations between the variables.
-   Further research needed.
